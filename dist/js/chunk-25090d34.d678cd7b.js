(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25090d34"],{3837:function(e,t,n){var i=n("da0b"),o=n("c58e"),a=n("1277")("species");e.exports=function(e){var t;return o(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!o(t.prototype)||(t=void 0),i(t)&&(t=t[a],null===t&&(t=void 0))),void 0===t?Array:t}},"95d3":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.onRefresh}}),n("el-button",{attrs:{type:"primary",plain:""},on:{click:e.onInsertClick}},[e._v("新增")]),n("el-button",{attrs:{type:"danger",plain:"",disabled:e.selection.length<1},on:{click:e.onDeleteSelection}},[e._v("删除")]),n("el-table",{staticStyle:{width:"100%"},attrs:{"default-expand-all":"",data:e.tableData,stripe:"","row-key":"id","tree-props":{children:"sub_role",hasChildren:"hasSubRole"}}},[n("el-table-column",{attrs:{prop:"name",label:"角色名称"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(n){return e.onUpdateClick(t.row)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(n){return e.onDeleteRow(t.row.id)}}})]}}])})],1),e.page?n("div",{staticStyle:{"text-align":"center",margin:"10px"}},[n("el-pagination",{attrs:{"current-page":e.page.index,"page-sizes":[10,20,50,100,"all"],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":function(t){return e.loadData({size:t,index:e.page.index})},"current-change":function(t){return e.loadData({size:e.page.size,index:t})}}})],1):e._e(),n("el-dialog",{attrs:{title:e.isUpdateForm?"编辑":"新增",visible:e.formVisible,width:"600px"},on:{open:e.openForm,"update:visible":function(t){e.formVisible=t},close:e.resetForm}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"角色名称"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"父级角色"}},[n("el-tree",{attrs:{data:e.tableData,"default-expand-all":"",props:{value:"id",label:"name",children:"sub_role"}},on:{"node-click":e.onParentRoleClick},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var i=t.data;return n("span",{},[n("span",[e._v("\n                             "+e._s(i.name)+"\n                             "),i.id===e.form.pid?n("i",{staticClass:"el-icon-check"}):e._e()])])}}])})],1),n("el-form-item",{attrs:{label:"权限规则"}},e._l(e.selectRoleRules,(function(t){return n("el-checkbox",{key:t.id,model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"rule.checked"}},[e._v(e._s(t.name))])})),1),n("el-form-item",[e.isUpdateForm?n("el-button",{attrs:{type:"primary"},on:{click:e.onFormUpdate}},[e._v("更新")]):n("el-button",{attrs:{type:"primary"},on:{click:e.onFormSave}},[e._v("保存")])],1)],1)],1)],1)},o=[],a=(n("bada"),"/role"),r={name:"",pid:"0",rules:[]},s={name:"role",data:function(){return{isUpdateForm:!1,formVisible:!1,formLoading:!1,form:r,selection:[],tableData:[],parentRoleRules:[],page:{size:10,index:1,total:0}}},created:function(){this.loadData()},computed:{selectRoleRules:{get:function(){var e=this;return this.parentRoleRules.map((function(t){return e.form.rules.find((function(e){e.id,t.id}))?t.checked=!0:t.checked=!1,t}))},set:function(e){console.log(e),this.form.rules=e.filter((function(e){return e.checked}))}}},methods:{openForm:function(){this.loadFormPidRules()},onParentRoleClick:function(e){this.form.pid=e.id,this.loadFormPidRules()},loadFormPidRules:function(){var e=this;0===this.form.pid?this.$request.post("/rule/index",{page:{index:1,size:"all"}}).then((function(t){e.parentRoleRules=t.data.list})):this.$request.get("/role/rules?id="+this.form.pid).then((function(t){e.parentRoleRules=t.data}))},loadData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$request.post(a+"/index",{page:t,where:n}).then((function(t){e.tableData=t.data.list,e.page=t.data.page}))},beforeUploadSingleImage:function(e){if(e.size>2097152)return this.$message.warning("上传文件不能大于2m"),!1},successUploadSingleImage:function(e){this.form.image=e.data},onRefresh:function(){this.loadData()},onSelectionChange:function(e){this.selection=e},onDeleteSelection:function(){this.onDeleteRow(this.selection.map((function(e){return e.id})))},onDeleteRow:function(e){var t=this;e instanceof Array&&(e=e.join(",")),this.$request(a+"/delete?ids="+e).then((function(){t.$message.success("删除成功"),t.loadData()}))},onInsertClick:function(){this.formVisible=!0,this.isUpdateForm=!1},onUpdateClick:function(e){this.form=e,this.formVisible=!0,this.isUpdateForm=!0},resetForm:function(){this.form=r},onFormSave:function(){var e=this;this.formLoading=!0,this.$request.post(a+"/save",this.form).then((function(){e.$message.success("保存成功"),e.formVisible=!1,e.loadData(),e.formLoading=!1})).catch((function(){e.formLoading=!1}))},onFormUpdate:function(){var e=this;this.formLoading=!0,this.$request.put(a+"/update",this.form).then((function(){e.$message.success("更新成功"),e.formVisible=!1,e.loadData(),e.formLoading=!1})).catch((function(){e.formLoading=!1}))}}},l=s,c=n("4e82"),u=Object(c["a"])(l,i,o,!1,null,"5657f643",null);t["default"]=u.exports},bada:function(e,t,n){"use strict";var i=n("2498"),o=n("ce67")(5),a="find",r=!0;a in[]&&Array(1)[a]((function(){r=!1})),i(i.P+i.F*r,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n("ab19")(a)},c017:function(e,t,n){var i=n("3837");e.exports=function(e,t){return new(i(e))(t)}},c58e:function(e,t,n){var i=n("6077");e.exports=Array.isArray||function(e){return"Array"==i(e)}},ce67:function(e,t,n){var i=n("e85e"),o=n("9952"),a=n("a9cf"),r=n("8941"),s=n("c017");e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,d=6==e,f=5==e||d,p=t||s;return function(t,s,m){for(var h,g,b=a(t),v=o(b),k=i(s,m,3),y=r(v.length),x=0,R=n?p(t,y):l?p(t,0):void 0;y>x;x++)if((f||x in v)&&(h=v[x],g=k(h,x,b),e))if(n)R[x]=g;else if(g)switch(e){case 3:return!0;case 5:return h;case 6:return x;case 2:R.push(h)}else if(u)return!1;return d?-1:c||u?u:R}}}}]);
//# sourceMappingURL=chunk-25090d34.d678cd7b.js.map